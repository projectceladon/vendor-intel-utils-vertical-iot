From 493314405ca856014a28449ed060e832fdb33239 Mon Sep 17 00:00:00 2001
From: kalle <kalyan.alle@intel.com>
Date: Thu, 13 Jan 2022 15:16:55 +0800
Subject: [PATCH] GMMLIB code changes to support rpl platform

---
 Source/GmmLib/Platform/GmmGen12Platform.cpp | 4 +++-
 Source/inc/common/igfxfmid.h                | 8 ++++++++
 2 files changed, 11 insertions(+), 1 deletion(-)

diff --git a/Source/GmmLib/Platform/GmmGen12Platform.cpp b/Source/GmmLib/Platform/GmmGen12Platform.cpp
index 419f8b5..545ebce 100644
--- a/Source/GmmLib/Platform/GmmGen12Platform.cpp
+++ b/Source/GmmLib/Platform/GmmGen12Platform.cpp
@@ -308,7 +308,9 @@ FCRECTALIGN(TILE__64_2D_128bpe, 128,  32,  32,   32, 32);
     Data.NoOfBitsSupported                = 39;
     Data.HighestAcceptablePhysicalAddress = GFX_MASK_LARGE(0, 38);
     if(GFX_GET_CURRENT_PRODUCT(Data.Platform) == IGFX_ALDERLAKE_S ||
-       (GFX_GET_CURRENT_PRODUCT(Data.Platform) == IGFX_ALDERLAKE_P) || (GFX_GET_CURRENT_PRODUCT(Data.Platform) >= IGFX_XE_HP_SDV))
+	(GFX_GET_CURRENT_PRODUCT(Data.Platform) == IGFX_ALDERLAKE_P) ||
+	(GFX_GET_CURRENT_PRODUCT(Data.Platform) == IGFX_RAPTORLAKE_S) ||
+	(GFX_GET_CURRENT_PRODUCT(Data.Platform) >= IGFX_XE_HP_SDV))
     {
         Data.NoOfBitsSupported                = 46;
         Data.HighestAcceptablePhysicalAddress = GFX_MASK_LARGE(0, 45);
diff --git a/Source/inc/common/igfxfmid.h b/Source/inc/common/igfxfmid.h
index 603e814..23b5d94 100644
--- a/Source/inc/common/igfxfmid.h
+++ b/Source/inc/common/igfxfmid.h
@@ -70,6 +70,7 @@ typedef enum {
     IGFX_ROCKETLAKE,
     IGFX_ALDERLAKE_S,
     IGFX_ALDERLAKE_P,
+    IGFX_RAPTORLAKE_S,
 
     IGFX_DG1  = 1210,
     IGFX_XE_HP_SDV = 1250,
@@ -102,6 +103,7 @@ typedef enum {
     PCH_JSP_N,          // JSL N PCH Device IDs for JSL+ Rev02
     PCH_ADL_S,          // ADL_S PCH
     PCH_ADL_P,          // ADL_P PCH
+    PCH_RPL_S,          // RPL_S PCH
     PCH_TGL_H,          // TGL H PCH
     PCH_PRODUCT_FAMILY_FORCE_ULONG = 0x7fffffff
 } PCH_PRODUCT_FAMILY;
@@ -1294,6 +1296,12 @@ typedef enum __NATIVEGTTYPE
 #define DEV_ID_46C2                             0x46C2
 #define DEV_ID_46C3                             0x46C3
 
+//RPL-S PCH Device IDs
+#define DEV_ID_A780                             0xA780
+#define DEV_ID_A781                             0xA781
+#define DEV_ID_A782                             0xA782
+#define DEV_ID_A783                             0xA783
+
 //ICL PCH LP Device IDs
 #define ICP_LP_RESERVED_FUSE_ID                 0x3480
 #define ICP_LP_U_SUPER_SKU_ID                   0x3481
-- 
2.17.1

